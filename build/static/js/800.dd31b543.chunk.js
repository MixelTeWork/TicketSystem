"use strict";(self.webpackChunkticket_system=self.webpackChunkticket_system||[]).push([[800],{8800:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ne}});var r=t(7689),s=t(4165),c=t(5861),a=t(1933),i=t(3144),l=t(5671),o=t(136),d=t(516),u=function(e){(0,o.Z)(t,e);var n=(0,d.Z)(t);function t(){return(0,l.Z)(this,t),n.apply(this,arguments)}return(0,i.Z)(t)}((0,t(8737).Z)(Error));function h(){return(0,a.useQuery)("user",v,{staleTime:1/0,cacheTime:1/0})}function v(){return x.apply(this,arguments)}function x(){return(x=(0,c.Z)((0,s.Z)().mark((function e(){var n,t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/user");case 2:return n=e.sent,e.next=5,n.json();case 5:if(t=e.sent,401!=n.status){e.next=8;break}return e.abrupt("return",{auth:!1,id:-1,login:"",name:"",operations:[]});case 8:if(n.ok){e.next=10;break}throw new u(t.msg);case 10:return(r=t).auth=!0,e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,n){var t,r;return!(null===(t=e.data)||void 0===t||!t.auth||null===(r=e.data)||void 0===r||!r.operations.includes(n))}var j=t(5086),p=t(2791);function m(){var e=(0,r.TH)().pathname;return(0,p.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var _={root:"styles_root__4DGhY"},g=t(184);function y(){var e=(0,r.s0)();return(0,g.jsx)("div",{className:_.root,children:(0,g.jsx)("button",{onClick:function(){return e(-1)},children:"\u041d\u0430\u0437\u0430\u0434"})})}function b(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.filter((function(e){return!!e})).join(" ")}var A=t(1087),k={root:"styles_root__Zvl9c",home:"styles_home__o+-s7",block:"styles_block__a1SM7"},N="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAN1wAADdcBQiibeAAAAJZQTFRFAAAAAAAB/tJS3TBS/NBR0S1OCgkG1i5Q8sdOOA0YmiI77YwY/9lVAAAD/+FX/JUarmcT85AZAAADnYI0oiM9ghwyAAADwZ8/UBEgSSsKhm8tLwoUFgoJZz0MST0a1a9FXEwgLCENHxYKAAADAAAD47xJryZCbFklu24UPDEVAAADYRUm1X4WfUsPAAADAAADemUqh1APjS8vDgAAADJ0Uk5TAP///////////////z3/////EP///yP///////////////+o5f//////v////1uK////wwoLAAACS0lEQVR4nOWXbXOiMBSFPYDilhhArFZKAWkVbdmK///P7Q0RZHfAMcl+2dkzY0IM5yFvJJfJ5P/SUte4BhaUfQN6CPIDH58fItMhNP5O6gThf6u2ySzZVlsNQuP3Qz/06OerE6TfCysv9EjKhNYfAJ6nQWj9/s8WoEa4+v0g8C/HUJ3Qjt8FCPyw0yBhMSS6b3cMAmo+LkFPx4L+Waz7/jM09N0DfOoA3nsAIFk9KWk1A27+d+DZdpVkvwBn6V6uRQfcqapEJ5bL5umkg62sp8Z4nog0OdhfPxT1ZR8S4SXA68G94pR0sN1V0gBe7Kn7DMyUBKzcqf3aB2zmj8uJhgDMelhsEGA5TlPrUO6IRKaOIwuyQmZjAEu2j3K6ZvM5ay7pWtZQLutHAVwMJXJeg2wnIBVtzXhSs30z2/wk6md8FMDiGkW94Tn2rESeIuYx9jkiliGN44hFdYI6YqMAh3Gk3GIEoIdxjpoANUpmZYg4JyPfgbJxAHUipdskgImBiKnpND0Zih092RGAO2PwJ2DuNIBatGCXihuUANSFkrqwKZCxaxcUALdBzDIkBDiVZcweACQlAdppzOU0lnD2Yv4KqkopuQeQK69ZOnIhMVnoFqW8uge4ybJ+L/WKwwDjl8n0ddbfUIy3NMNN1XhbNz5YzI+2v3G4mh/vxgHGpItnbnEMtbE4tvHMkIYjqi6S8sk/FlEN6xrTXXWpqkuoFxW2saCv6u8TwjfsfP3IWBAqncj6Fpt6mrG9+deF+feN+ReW+TdeJ0P7P6RfA+lYkv8rr7AAAAAASUVORK5CYII=";function w(e,n){return fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:void 0===n?null:JSON.stringify(n)})}function Z(e){return S.apply(this,arguments)}function S(){return(S=(0,c.Z)((0,s.Z)().mark((function e(n){var t,r,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/auth",n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new u(r.msg);case 8:return(c=r).auth=!0,e.abrupt("return",c);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return C.apply(this,arguments)}function C(){return(C=(0,c.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/logout");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){var e,n=(0,r.TH)(),t=(0,r.s0)(),s=(0,a.useQueryClient)(),c=(0,a.useMutation)({mutationFn:D,onSuccess:function(){s.invalidateQueries("user"),t("/auth")}}),i=h();return(0,g.jsxs)("div",{className:k.root,children:[(0,g.jsxs)("span",{className:k.block,children:[(0,g.jsx)(A.rU,{to:"/",className:k.home,children:(0,g.jsx)("img",{src:N,alt:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"})}),"/"!=n.pathname&&(0,g.jsx)("button",{onClick:function(){return t(-1)},children:"\u041d\u0430\u0437\u0430\u0434"})]}),(0,g.jsxs)("span",{className:k.block,children:[(0,g.jsx)("span",{children:null===(e=i.data)||void 0===e?void 0:e.name}),(0,g.jsx)("button",{onClick:function(){return c.mutate()},disabled:"loading"==c.status,children:"\u0412\u044b\u0439\u0442\u0438"})]})]})}var F={root:"styles_root__xvR2N",body:"styles_body__S-p4X",body_centered:"styles_body_centered__NzRPU",body_centeredPage:"styles_body_centeredPage__R-EzO"};function M(e){var n=e.children,t=e.className,r=e.centered,s=void 0!==r&&r,c=e.centeredPage,a=void 0!==c&&c,i=e.height100,l=void 0!==i&&i,o=e.gap,d=void 0===o?0:o,u=e.header,h=void 0===u?(0,g.jsx)(E,{}):u;return(0,g.jsxs)("div",{className:F.root,style:{maxHeight:l?"100dvh":""},children:[h||(0,g.jsx)("div",{}),(0,g.jsx)("div",{className:b(F.body,t,s&&F.body_centered,a&&F.body_centeredPage),style:{gap:d,maxHeight:l?"100%":""},children:n})]})}function I(){return(0,g.jsx)(M,{centered:!0,header:(0,g.jsx)(y,{}),children:"\u0422\u0430\u043a\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043d\u0435\u0442"})}function U(){return(0,g.jsx)(M,{centered:!0,header:(0,g.jsx)(y,{}),children:"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u0442\u043e\u0447\u043d\u043e \u043f\u0440\u0430\u0432 \u043d\u0430 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b"})}var T=t(9439),B={form:"styles_form__n7Rcu",field:"styles_field__+iIr8"};function P(){var e=(0,a.useQueryClient)(),n=(0,r.s0)(),t=(0,p.useState)(""),s=(0,T.Z)(t,2),c=s[0],i=s[1],l=(0,p.useRef)(null),o=(0,p.useRef)(null),d=(0,a.useMutation)({mutationFn:Z,onSuccess:function(t){e.setQueryData("user",(function(){return t})),n("/")},onError:function(e){i(e instanceof u?e.message:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437")}});return(0,g.jsxs)(M,{header:null,centered:!0,gap:"2em",children:[(0,g.jsx)("h1",{children:"\u0411\u0438\u043b\u0435\u0442\u043d\u0430\u044f \u0421\u0438\u0441\u0442\u0435\u043c\u0430"}),c&&(0,g.jsx)("h3",{children:c}),(0,g.jsxs)("form",{className:B.form,onSubmit:function(e){var n,t;e.preventDefault();var r=(null===(n=l.current)||void 0===n?void 0:n.value)||"",s=(null===(t=o.current)||void 0===t?void 0:t.value)||"";d.mutate({login:r,password:s})},children:[(0,g.jsxs)("label",{className:B.field,children:[(0,g.jsx)("span",{children:"\u041b\u043e\u0433\u0438\u043d"}),(0,g.jsx)("input",{ref:l,type:"text",name:"login",required:!0})]}),(0,g.jsxs)("label",{className:B.field,children:[(0,g.jsx)("span",{children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),(0,g.jsx)("input",{ref:o,type:"password",name:"password",required:!0})]}),(0,g.jsx)("button",{type:"submit",disabled:"loading"==d.status,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}function R(){var e=h();return(0,g.jsxs)(M,{centered:!0,gap:"1em",children:[f(e,"page_scanner")&&(0,g.jsx)(A.rU,{to:"/scanner",className:"button button_large",children:"\u0421\u043a\u0430\u043d\u0435\u0440"}),f(e,"page_events")&&(0,g.jsx)(A.rU,{to:"/events",className:"button button_large",children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f"}),f(e,"page_staff")&&(0,g.jsx)(A.rU,{to:"/staff",className:"button button_large",children:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438"})]})}var O={scanner:"styles_scanner__+xzXT",scanner_scanned:"styles_scanner_scanned__lX+Yf",scanned_anim:"styles_scanned_anim__UmXGC",scanResult:"styles_scanResult__35K03",big:"styles_big__bcOVH",success:"styles_success__dlqOt",result_desc:"styles_result_desc__oS+OA",error:"styles_error__0ctGO"},Q=t(1413);function Y(){return(0,a.useQuery)("events",J)}function J(){return L.apply(this,arguments)}function L(){return(L=(0,c.Z)((0,s.Z)().mark((function e(){var n,t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/events");case 2:return n=e.sent,e.next=5,n.json();case 5:if(t=e.sent,n.ok){e.next=8;break}throw new u(t.msg);case 8:return r=t,e.abrupt("return",r.map((function(e){return(0,Q.Z)((0,Q.Z)({},e),{},{date:new Date(e.date)})})));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){var n=e.setEvent,t=Y();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h2",{children:"\u0412\u044b\u0431\u043e\u0440 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f"}),t.isError&&"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430",t.isLoading&&"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0439",t.isSuccess&&(0,g.jsx)(g.Fragment,{children:t.data.map((function(e){return(0,g.jsx)("button",{className:"button button_large",onClick:function(){return n(e)},children:e.name},e.id)}))})]})}var K={root:"styles_root__QdJnV"},X=t(1096);function G(e){var n=e.active,t=void 0===n||n,r=e.onScan,s=(0,p.useState)(),c=(0,T.Z)(s,2),a=c[0],i=c[1],l=(0,p.useRef)(null);return(0,p.useEffect)((function(){if(l.current){var e=new X.Z(l.current,(function(e){return r(e.data)}),{highlightScanRegion:!0,maxScansPerSecond:10});return i((function(n){return null===n||void 0===n||n.stop(),null===n||void 0===n||n.destroy(),e})),e.start(),function(){e.stop(),e.destroy()}}}),[l,r]),(0,p.useEffect)((function(){a&&(t?a.start():a.pause(!1))}),[t,a]),(0,g.jsx)("video",{className:K.root,ref:l})}var H=t(3433);function V(e,n){return"".concat(e).padStart(n,"0")}function W(e,n,t,r){var s="".concat(e);return"1"==s.at(-1)&&"1"!=s.at(-2)?n:["2","3","4"].includes(s.at(-1)||"")&&"1"!=s.at(-2)?t:r}function q(e){return e?"".concat(V(e.getDate(),2),".").concat(V(e.getMonth()+1,2),".").concat(e.getFullYear()):""}function $(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t="".concat(V(e.getHours(),2),":").concat(V(e.getMinutes(),2));return n?t+":".concat(V(e.getSeconds(),2)):t}function ee(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"second",t=new Date,r=e.getTime()-t.getTime(),s=Math.floor(Math.abs(r)/1e3),c=Math.floor(s/31104e3);s-=60*c*60*24*30*12;var a=Math.floor(s/2592e3);s-=60*a*60*24*30;var i=Math.floor(s/86400);s-=60*i*60*24;var l=Math.floor(s/3600)%24;s-=60*l*60;var o=Math.floor(s/60)%60,d=(s-=60*o)%60;var u=function(){var e=function(e){return[e,["","",""]]};return 0!=c?[c,["\u0433\u043e\u0434","\u0433\u043e\u0434\u0430","\u043b\u0435\u0442"]]:0!=a?[a,["\u043c\u0435\u0441\u044f\u0446","\u043c\u0435\u0441\u044f\u0446\u0430","\u043c\u0435\u0441\u044f\u0446\u043e\u0432"]]:0!=i?[i,["\u0434\u0435\u043d\u044c","\u0434\u043d\u044f","\u0434\u043d\u0435\u0439"]]:"day"==n?e("\u0421\u0435\u0433\u043e\u0434\u043d\u044f"):0!=l?[l,["\u0447\u0430\u0441","\u0447\u0430\u0441\u0430","\u0447\u0430\u0441\u043e\u0432"]]:"hour"==n?e("\u0421\u0435\u0439\u0447\u0430\u0441"):0!=o?[o,["\u043c\u0438\u043d\u0443\u0442\u0430","\u043c\u0438\u043d\u0443\u0442\u044b","\u043c\u0438\u043d\u0443\u0442"]]:"minute"==n?e("\u0421\u0435\u0439\u0447\u0430\u0441"):0!=d?[d,["\u0441\u0435\u043a\u0443\u043d\u0434\u0430","\u0441\u0435\u043a\u0443\u043d\u0434\u044b","\u0441\u0435\u043a\u0443\u043d\u0434"]]:e("\u0422\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e")}(),h=(0,T.Z)(u,2),v=h[0],x=h[1];if("string"==typeof v)return v;var f="".concat(W.apply(void 0,[v].concat((0,H.Z)(x))));return Math.abs(v)>1&&(f=Math.abs(v)+" "+f),r>0?f="\u0427\u0435\u0440\u0435\u0437 "+f:f+=" \u043d\u0430\u0437\u0430\u0434",f}var ne={root:"styles_root__E-Z+Q",top:"styles_top__r6L7-",bottom:"styles_bottom__GMtUi"};function te(e){var n=e.event,t=e.onBackBtn,r=e.onInputBtn;return(0,g.jsxs)("div",{className:ne.root,children:[(0,g.jsxs)("div",{className:ne.top,children:[(0,g.jsx)("button",{onClick:t,children:"\u041d\u0430\u0437\u0430\u0434"}),(0,g.jsx)("button",{onClick:r,children:"\u0420\u0443\u0447\u043d\u043e\u0439 \u0432\u0432\u043e\u0434"})]}),(0,g.jsxs)("div",{className:ne.bottom,children:[(0,g.jsx)("span",{children:n.name}),(0,g.jsx)("span",{children:"|"}),(0,g.jsx)("span",{children:q(n.date)})]})]})}function re(e){return(0,a.useQuery)(["tickets",e],(function(){return function(e){return se.apply(this,arguments)}(e)}))}function se(){return(se=(0,c.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/tickets/"+n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new u(r.msg);case 8:return e.abrupt("return",r.map((function(e){return ce(e)})));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){var n=e;return e.scannedDate&&(n.scannedDate=new Date(e.scannedDate)),e.createdDate&&(n.createdDate=new Date(e.createdDate)),n}function ae(e){return ie.apply(this,arguments)}function ie(){return(ie=(0,c.Z)((0,s.Z)().mark((function e(n){var t,r,c,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/check_ticket",n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new u(r.msg);case 8:return a=r,(c=r).ticket&&(a.ticket=ce(c.ticket)),e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var le={root:"styles_root__O0923",open:"styles_open__35Vcu",popup:"styles_popup__L-0H0",header:"styles_header__o87wG",close:"styles_close__w0Yhz",body:"styles_body__t75Nd"};function oe(e){var n=e.children,t=e.open,r=void 0!==t&&t,s=e.close,c=e.title,a=void 0===c?"":c;return(0,g.jsx)("div",{className:b(le.root,r&&le.open),children:(0,g.jsxs)("div",{className:le.popup,children:[(0,g.jsxs)("div",{className:le.header,children:[(0,g.jsx)("h3",{children:a}),(0,g.jsx)("button",{className:le.close,onClick:s,children:"\u2716"})]}),(0,g.jsx)("div",{className:le.body,children:n})]})})}function de(){var e,n,t=(0,p.useState)(null),r=(0,T.Z)(t,2),s=r[0],c=r[1],i=(0,p.useState)(null),l=(0,T.Z)(i,2),o=l[0],d=l[1],v=(0,p.useState)(null),x=(0,T.Z)(v,2),f=x[0],j=x[1],m=(0,p.useState)(null),_=(0,T.Z)(m,2),y=_[0],A=_[1],k=(0,p.useState)(null),N=(0,T.Z)(k,2),w=N[0],Z=N[1],S=(0,p.useState)(!1),D=(0,T.Z)(S,2),C=D[0],E=D[1],F=(0,p.useRef)(null),I=(0,p.useCallback)((function(e){return d(e)}),[]),U=(0,p.useCallback)((function(){c(null),d(null),j(null),A(null),Z(null),J.reset()}),[]),B=(0,p.useCallback)((function(){E(!0),F.current&&s&&(F.current.value="".concat(V(s.id,3),"-").concat(s.date.getFullYear().toString().at(-1)).concat(V(s.date.getMonth()+1,2)).concat(V(s.date.getDate(),2),"-"))}),[F,s]),P=(0,p.useCallback)((function(){return E(!1)}),[]),R=h(),Q=Y(),J=(0,a.useMutation)({mutationFn:ae,onSuccess:function(e){Z(e)},onError:function(e){Z(null),A(e instanceof u?e.message:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"),J.reset()}});return(0,p.useEffect)((function(){o&&s&&"idle"==J.status&&(j(o),A(null),d(null),Z(null),J.mutate({code:o,eventId:s.id}))}),[o,s,J]),(0,p.useEffect)((function(){if(J.isSuccess){var e=setTimeout((function(){d(null),J.reset()}),1e3);return function(){return clearTimeout(e)}}}),[J]),(0,g.jsxs)(g.Fragment,{children:[!s&&(0,g.jsx)(M,{centered:!0,gap:"1em",children:(0,g.jsx)(z,{setEvent:c})}),s&&(0,g.jsxs)(M,{height100:!0,header:(0,g.jsx)(te,{event:s,onBackBtn:U,onInputBtn:B}),children:[(0,g.jsx)("div",{className:b(O.scanner,!J.isIdle&&O.scanner_scanned),children:(0,g.jsx)(G,{onScan:I})}),(0,g.jsxs)("div",{className:O.scanResult,children:[f&&(0,g.jsxs)("div",{children:["\u041a\u043e\u0434 \u0431\u0438\u043b\u0435\u0442\u0430: ",f]}),y&&(0,g.jsx)("div",{children:y}),(null===w||void 0===w?void 0:w.success)&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:b(O.success,O.big),children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u0435\u043d"}),(0,g.jsxs)("div",{className:O.result_desc,children:[(0,g.jsxs)("div",{children:["\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c: ",w.ticket.personName]}),(0,g.jsxs)("div",{children:["\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430: ",w.ticket.type]}),(0,g.jsxs)("div",{children:["\u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434: ",w.ticket.promocode]})]})]}),"notExist"==(null===w||void 0===w?void 0:w.errorCode)&&(0,g.jsx)("div",{className:b(O.error,O.big),children:"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"}),"event"==(null===w||void 0===w?void 0:w.errorCode)&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:b(O.error,O.big),children:"\u0414\u0440\u0443\u0433\u043e\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"}),(0,g.jsxs)("div",{className:O.result_desc,children:[function(e){var n=null===(e=Q.data)||void 0===e?void 0:e.find((function(e){return e.id==w.ticket.eventId}));return n?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{children:["\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435: ",n.name]}),(0,g.jsxs)("div",{children:["\u0415\u0433\u043e \u0434\u0430\u0442\u0430: ",q(n.date)," (",ee(n.date,"day"),")"]})]}):(0,g.jsx)("div",{children:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"})}(),(0,g.jsxs)("div",{children:["\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c: ",w.ticket.personName]})]})]}),"scanned"==(null===w||void 0===w?void 0:w.errorCode)&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:b(O.error,O.big),children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0439"}),(0,g.jsxs)("div",{className:O.result_desc,children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{children:"\u041a\u0435\u043c: "}),w.ticket.scannedById==(null===(e=R.data)||void 0===e?void 0:e.id)?(0,g.jsx)("span",{children:"\u0412\u0430\u043c\u0438"}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("span",{children:[w.ticket.scannedBy," "]}),(0,g.jsx)("span",{className:O.error,children:"(\u041d\u0435 \u0432\u0430\u043c\u0438)"})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{children:"\u041a\u043e\u0433\u0434\u0430: "}),(0,g.jsxs)("span",{children:[$(w.ticket.scannedDate,!0)," "]}),(0,g.jsxs)("span",{className:b((n=w.ticket.scannedDate,((new Date).getTime()-n.getTime())/1e3>30&&O.error)),children:["(",ee(w.ticket.scannedDate),")"]})]}),(0,g.jsxs)("div",{style:{marginTop:"0.5rem"},children:["\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c: ",w.ticket.personName]}),(0,g.jsxs)("div",{children:["\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430: ",w.ticket.type]}),(0,g.jsxs)("div",{children:["\u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434: ",w.ticket.promocode]})]})]})]}),(0,g.jsxs)(oe,{title:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0431\u0438\u043b\u0435\u0442\u0430",open:C,close:P,children:[(0,g.jsx)("input",{type:"text",ref:F}),(0,g.jsx)("button",{disabled:"idle"!=J.status,onClick:function(){var e;F.current&&d(null===(e=F.current)||void 0===e?void 0:e.value),P()},children:"\u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})]})]})}var ue={space_between:"styles_space_between__AD+M6"};function he(){var e,n=Y();return(0,g.jsxs)(M,{centeredPage:!0,gap:"1rem",children:[(0,g.jsx)("h1",{children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f"}),n.isLoading&&(0,g.jsx)("div",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),n.isError&&(0,g.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),null===(e=n.data)||void 0===e?void 0:e.map((function(e){return(0,g.jsxs)(A.rU,{to:"/events/".concat(e.id),className:b("button button_large",ue.space_between),children:[(0,g.jsx)("span",{children:e.name}),(0,g.jsx)("span",{children:q(e.date)})]},e.id)})),(0,g.jsxs)("div",{className:ue.space_between,children:[(0,g.jsx)("span",{}),(0,g.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})]})}function ve(){return(0,g.jsx)(M,{centered:!0,children:"\u0422\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432"})}var xe={card:"styles_card__1zOYj",card__header:"styles_card__header__o4cfX",card__body:"styles_card__body__KU56x",gap:"styles_gap__Z5dnR",right:"styles_right__fxm89"};function fe(e){return(0,a.useQuery)(["ticket_types",e],(function(){return function(e){return je.apply(this,arguments)}(e)}))}function je(){return(je=(0,c.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/ticket_types/"+n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new u(r.msg);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(){var e,n,t=(0,r.UO)(),s=parseInt(t.eventId,10),c=Y(),a=null===(e=c.data)||void 0===e?void 0:e.find((function(e){return e.id==s})),i=fe(s);return(0,g.jsxs)(g.Fragment,{children:[c.isLoading&&(0,g.jsx)(M,{centered:!0,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),c.isError&&(0,g.jsx)(M,{centered:!0,children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),a&&(0,g.jsxs)(M,{centeredPage:!0,gap:"1rem",children:[(0,g.jsxs)("h1",{children:["\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435: ",a.name]}),(0,g.jsxs)("div",{className:xe.card,children:[(0,g.jsxs)("div",{className:xe.card__header,children:[(0,g.jsx)("h2",{children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"}),(0,g.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]}),(0,g.jsxs)("div",{className:xe.card__body,children:[(0,g.jsxs)("div",{children:["\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435: ",a.name]}),(0,g.jsxs)("div",{children:["\u0414\u0430\u0442\u0430 \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f: ",q(a.date)]})]})]}),(0,g.jsxs)("div",{className:xe.card,children:[(0,g.jsxs)("div",{className:xe.card__header,children:[(0,g.jsx)("h2",{children:"\u0412\u0438\u0434\u044b \u0431\u0438\u043b\u0435\u0442\u043e\u0432"}),(0,g.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]}),(0,g.jsxs)("div",{className:xe.card__body,children:[i.isLoading&&(0,g.jsx)("div",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),i.isError&&(0,g.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),null===(n=i.data)||void 0===n?void 0:n.map((function(e){return(0,g.jsx)("div",{children:e.name},e.id)}))]})]}),(0,g.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0431\u0438\u043b\u0435\u0442"}),(0,g.jsx)(A.rU,{to:"/events/".concat(s,"/tickets"),className:"button",children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0431\u0438\u043b\u0435\u0442\u043e\u0432"}),(0,g.jsx)("div",{className:xe.gap}),(0,g.jsx)("div",{className:xe.right,children:(0,g.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})})]})]})}var me={center:"styles_center__9dZ9p",right:"styles_right__Zz+YX"},_e={root:"styles_root__L6Gyd",visible:"styles_visible__nfYo0",center:"styles_center__LDcBX"},ge=t(741),ye=t(5498),be=t.n(ye);function Ae(e){var n=e.event,t=e.ticket,r=(0,p.useState)(null),s=(0,T.Z)(r,2),c=s[0],a=s[1],i=(0,p.useState)(""),l=(0,T.Z)(i,2),o=l[0],d=l[1],u=(0,p.useRef)(null);return(0,p.useEffect)((function(){t&&(a(null),ge.toDataURL(t.code,{errorCorrectionLevel:"H",scale:8},(function(e,n){return d(n)})))}),[t]),(0,p.useEffect)((function(){if(o&&u.current){var e=setTimeout((function(){o&&u.current&&be()(u.current).then((function(e){return a(e)}))}),10);return function(){return clearTimeout(e)}}}),[o,u]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{ref:u,className:b(_e.root,!c&&_e.visible),children:[(0,g.jsx)("h1",{children:"\u0411\u0438\u043b\u0435\u0442"}),(0,g.jsx)("div",{className:_e.center,style:{marginTop:"1rem"},children:(0,g.jsx)("img",{src:o})}),(0,g.jsx)("div",{className:_e.center,style:{marginBottom:"1rem"},children:null===t||void 0===t?void 0:t.code}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{children:["\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435: ",null===n||void 0===n?void 0:n.name]}),(0,g.jsxs)("div",{children:["\u0414\u0430\u0442\u0430: ",q(null===n||void 0===n?void 0:n.date)]}),(0,g.jsxs)("div",{children:["\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430: ",null===t||void 0===t?void 0:t.type]}),(0,g.jsxs)("div",{children:["\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c: ",null===t||void 0===t?void 0:t.personName]})]})]}),c&&(0,g.jsx)("div",{ref:function(e){e&&(e.innerHTML="",e.appendChild(c))}})]})}function ke(){var e,n,t=(0,p.useState)(null),s=(0,T.Z)(t,2),c=s[0],a=s[1],i=(0,r.UO)(),l=parseInt(i.eventId,10),o=Y(),d=null===(e=o.data)||void 0===e?void 0:e.find((function(e){return e.id==l})),u=re(l);return(0,g.jsxs)(g.Fragment,{children:[o.isLoading&&(0,g.jsx)(M,{centered:!0,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),o.isError&&(0,g.jsx)(M,{centered:!0,children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),d&&(0,g.jsxs)(M,{centeredPage:!0,gap:"1rem",children:[(0,g.jsxs)("h1",{children:["\u0411\u0438\u043b\u0435\u0442\u044b: ",d.name]}),(0,g.jsxs)("div",{className:me.right,children:[(0,g.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0420\u0430\u0441\u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c"}),(0,g.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]}),(0,g.jsxs)("table",{children:[(0,g.jsx)("thead",{children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{style:{width:"11em"},children:"\u041a\u043e\u0434"}),(0,g.jsx)("th",{children:"\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c"}),(0,g.jsx)("th",{children:"\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430"}),(0,g.jsx)("th",{children:"\u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434"}),(0,g.jsxs)("th",{children:[(0,g.jsx)("div",{children:"\u0418\u0441\u043f\u043e\u043b\u044c"}),(0,g.jsx)("div",{children:"\u0437\u043e\u0432\u0430\u043d"})]}),(0,g.jsx)("th",{children:"\u0411\u0438\u043b\u0435\u0442"})]})}),(0,g.jsx)("tbody",{children:null===(n=u.data)||void 0===n?void 0:n.map((function(e){return(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:e.code}),(0,g.jsx)("td",{children:e.personName}),(0,g.jsx)("td",{children:e.type}),(0,g.jsx)("td",{children:e.promocode}),(0,g.jsx)("td",{className:me.center,children:e.scanned?"\u2713":"\u2716"}),(0,g.jsx)("td",{className:me.center,children:(0,g.jsx)("button",{onClick:function(){return a(e)},children:"\u0411\u0438\u043b\u0435\u0442"})})]},e.id)}))})]}),(0,g.jsx)(oe,{open:!!c,close:function(){return a(null)},title:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0431\u0438\u043b\u0435\u0442\u0430",children:(0,g.jsx)(Ae,{ticket:c,event:d})})]})]})}function Ne(){var e,n=h();function t(e,t,s){var c;return(0,g.jsx)(r.AW,{path:t,element:null!==(c=n.data)&&void 0!==c&&c.auth?null==e||f(n,e)?s:(0,g.jsx)(U,{}):(0,g.jsx)(r.Fg,{to:"/auth"})})}return(0,g.jsxs)("div",{className:"root",children:[(0,g.jsx)(m,{}),n.isLoading&&(0,g.jsx)(j.Z,{}),n.isError&&"\u041e\u0448\u0438\u0431\u043a\u0430",n.isSuccess&&(0,g.jsxs)(r.Z5,{children:[(0,g.jsx)(r.AW,{path:"/auth",element:null!==(e=n.data)&&void 0!==e&&e.auth?(0,g.jsx)(r.Fg,{to:"/"}):(0,g.jsx)(P,{})}),t(null,"/",(0,g.jsx)(R,{})),t("page_scanner","/scanner",(0,g.jsx)(de,{})),t("page_events","/events",(0,g.jsx)(he,{})),t("page_events","/events/:eventId",(0,g.jsx)(pe,{})),t("page_events","/events/:eventId/tickets",(0,g.jsx)(ke,{})),t("page_staff","/staff",(0,g.jsx)(ve,{})),t(null,"*",(0,g.jsx)(I,{}))]})]})}}}]);
//# sourceMappingURL=800.dd31b543.chunk.js.map