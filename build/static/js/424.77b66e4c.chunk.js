"use strict";(self.webpackChunkticket_system=self.webpackChunkticket_system||[]).push([[424],{4969:function(e,n,t){t.r(n),t.d(n,{default:function(){return Ge}});var r=t(7689),s=t(4165),i=t(5861),a=t(1933),c=t(3144),u=t(5671),o=t(136),l=t(516),d=function(e){(0,o.Z)(t,e);var n=(0,l.Z)(t);function t(){return(0,u.Z)(this,t),n.apply(this,arguments)}return(0,c.Z)(t)}((0,t(8737).Z)(Error));function h(){return(0,a.useQuery)("user",v)}function v(){return f.apply(this,arguments)}function f(){return(f=(0,i.Z)((0,s.Z)().mark((function e(){var n,t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/user");case 2:return n=e.sent,e.next=5,n.json();case 5:if(t=e.sent,401!=n.status){e.next=8;break}return e.abrupt("return",{auth:!1,id:-1,login:"",name:"",operations:[]});case 8:if(n.ok){e.next=10;break}throw new d(t.msg);case 10:return(r=t).auth=!0,e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,n){var t,r;return!(null===(t=e.data)||void 0===t||!t.auth||null===(r=e.data)||void 0===r||!r.operations.includes(n))}function p(e){var n,t,r=h();return!(null===(n=r.data)||void 0===n||!n.auth||null===(t=r.data)||void 0===t||!t.operations.includes(e))}var j=t(5086),m=t(2791);function _(){var e=(0,r.TH)().pathname;return(0,m.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var y={root:"styles_root__4DGhY"},b=t(184);function g(){var e=(0,r.s0)();return(0,b.jsx)("div",{className:y.root,children:(0,b.jsx)("button",{onClick:function(){return e(-1)},children:"\u041d\u0430\u0437\u0430\u0434"})})}function k(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.filter((function(e){return!!e})).join(" ")}var A=t(1087),N={root:"styles_root__Zvl9c",home:"styles_home__o+-s7",block:"styles_block__a1SM7"},Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAN1wAADdcBQiibeAAAAJZQTFRFAAAAAAAB/tJS3TBS/NBR0S1OCgkG1i5Q8sdOOA0YmiI77YwY/9lVAAAD/+FX/JUarmcT85AZAAADnYI0oiM9ghwyAAADwZ8/UBEgSSsKhm8tLwoUFgoJZz0MST0a1a9FXEwgLCENHxYKAAADAAAD47xJryZCbFklu24UPDEVAAADYRUm1X4WfUsPAAADAAADemUqh1APjS8vDgAAADJ0Uk5TAP///////////////z3/////EP///yP///////////////+o5f//////v////1uK////wwoLAAACS0lEQVR4nOWXbXOiMBSFPYDilhhArFZKAWkVbdmK///P7Q0RZHfAMcl+2dkzY0IM5yFvJJfJ5P/SUte4BhaUfQN6CPIDH58fItMhNP5O6gThf6u2ySzZVlsNQuP3Qz/06OerE6TfCysv9EjKhNYfAJ6nQWj9/s8WoEa4+v0g8C/HUJ3Qjt8FCPyw0yBhMSS6b3cMAmo+LkFPx4L+Waz7/jM09N0DfOoA3nsAIFk9KWk1A27+d+DZdpVkvwBn6V6uRQfcqapEJ5bL5umkg62sp8Z4nog0OdhfPxT1ZR8S4SXA68G94pR0sN1V0gBe7Kn7DMyUBKzcqf3aB2zmj8uJhgDMelhsEGA5TlPrUO6IRKaOIwuyQmZjAEu2j3K6ZvM5ay7pWtZQLutHAVwMJXJeg2wnIBVtzXhSs30z2/wk6md8FMDiGkW94Tn2rESeIuYx9jkiliGN44hFdYI6YqMAh3Gk3GIEoIdxjpoANUpmZYg4JyPfgbJxAHUipdskgImBiKnpND0Zih092RGAO2PwJ2DuNIBatGCXihuUANSFkrqwKZCxaxcUALdBzDIkBDiVZcweACQlAdppzOU0lnD2Yv4KqkopuQeQK69ZOnIhMVnoFqW8uge4ybJ+L/WKwwDjl8n0ddbfUIy3NMNN1XhbNz5YzI+2v3G4mh/vxgHGpItnbnEMtbE4tvHMkIYjqi6S8sk/FlEN6xrTXXWpqkuoFxW2saCv6u8TwjfsfP3IWBAqncj6Fpt6mrG9+deF+feN+ReW+TdeJ0P7P6RfA+lYkv8rr7AAAAAASUVORK5CYII=";function w(e,n){return fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:void 0===n?null:JSON.stringify(n)})}function S(e){return C.apply(this,arguments)}function C(){return(C=(0,i.Z)((0,s.Z)().mark((function e(n){var t,r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/auth",n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new d(r.msg);case 8:return(i=r).auth=!0,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return D.apply(this,arguments)}function D(){return(D=(0,i.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/logout");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E={root:"styles_root__BdzzK",spinner:"styles_spinner__rlI86","lds-ring":"styles_lds-ring__jnLuB"};function M(e){var n=e.color,t=e.zIndex;return(0,b.jsx)("div",{className:E.root,children:(0,b.jsxs)("div",{className:E.spinner,style:{"--color":n,zIndex:t},children:[(0,b.jsx)("div",{}),(0,b.jsx)("div",{}),(0,b.jsx)("div",{}),(0,b.jsx)("div",{})]})})}function F(){var e,n=(0,r.TH)(),t=(0,r.s0)(),s=function(){var e=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:I,onSuccess:function(){e.invalidateQueries("user")}})}(),i=h();return(0,b.jsxs)("div",{className:N.root,children:[(0,b.jsxs)("span",{className:N.block,children:[(0,b.jsx)(A.rU,{to:"/",className:N.home,children:(0,b.jsx)("img",{src:Z,alt:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"})}),"/"!=n.pathname&&(0,b.jsx)("button",{onClick:function(){return t(-1)},children:"\u041d\u0430\u0437\u0430\u0434"})]}),(0,b.jsxs)("span",{className:N.block,children:[(0,b.jsx)("span",{children:null===(e=i.data)||void 0===e?void 0:e.name}),(0,b.jsx)("button",{onClick:function(){return s.mutate()},disabled:"idle"!=s.status,children:"\u0412\u044b\u0439\u0442\u0438"})]}),"idle"!=s.status&&(0,b.jsx)(M,{})]})}var Q={root:"styles_root__xvR2N",body:"styles_body__S-p4X",body_centered:"styles_body_centered__NzRPU",body_centeredPage:"styles_body_centeredPage__R-EzO"};function R(e){var n=e.children,t=e.className,r=e.centered,s=void 0!==r&&r,i=e.centeredPage,a=void 0!==i&&i,c=e.height100,u=void 0!==c&&c,o=e.gap,l=void 0===o?0:o,d=e.header,h=void 0===d?(0,b.jsx)(F,{}):d;return(0,b.jsxs)("div",{className:Q.root,style:{maxHeight:u?"100dvh":""},children:[h||(0,b.jsx)("div",{}),(0,b.jsx)("div",{className:k(Q.body,t,s&&Q.body_centered,a&&Q.body_centeredPage),style:{gap:l,maxHeight:u?"100%":""},children:n})]})}function T(){return(0,b.jsx)(R,{centered:!0,header:(0,b.jsx)(g,{}),children:"\u0422\u0430\u043a\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u043d\u0435\u0442"})}function U(){return(0,b.jsx)(R,{centered:!0,header:(0,b.jsx)(g,{}),children:"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u0442\u043e\u0447\u043d\u043e \u043f\u0440\u0430\u0432 \u043d\u0430 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b"})}var L=t(9439),P={form:"styles_form__n7Rcu"},O=t(3433);function z(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u0411\u0438\u043b\u0435\u0442\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430";(0,m.useEffect)((function(){var t=document.title,r="object"!=typeof e?[e]:e;return document.title=[n].concat((0,O.Z)(r)).filter((function(e){return!!e})).join(" | "),function(){document.title=t}}),[e,n])}var B={form:"styles_form__cFFCH",field:"styles_field__5rpBk"};function Y(e){var n=e.className,t=e.style,r=e.onSubmit,s=e.children;return(0,b.jsx)("form",{className:k(B.form,n),style:t,onSubmit:function(e){e.preventDefault(),r()},children:s})}function V(e){var n=e.label,t=e.className,r=e.style,s=e.children;return(0,b.jsxs)("label",{className:k(B.field,t),style:r,children:[(0,b.jsx)("span",{children:n}),s]})}function K(){z("\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f");var e=(0,m.useState)(""),n=(0,L.Z)(e,2),t=n[0],r=n[1],s=(0,m.useRef)(null),i=(0,m.useRef)(null),c=function(e){var n=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:S,onSuccess:function(e){n.setQueryData("user",(function(){return e}))},onError:function(n){null===e||void 0===e||e(n instanceof d?n.message:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437")}})}(r);return(0,b.jsxs)(R,{header:null,centered:!0,centeredPage:!0,gap:"2em",children:[(0,b.jsx)("h1",{children:"\u0411\u0438\u043b\u0435\u0442\u043d\u0430\u044f \u0421\u0438\u0441\u0442\u0435\u043c\u0430"}),t&&(0,b.jsx)("h3",{children:t}),c.isLoading&&(0,b.jsx)(M,{}),(0,b.jsxs)(Y,{className:P.form,onSubmit:function(){var e,n,t=(null===(e=s.current)||void 0===e?void 0:e.value)||"",r=(null===(n=i.current)||void 0===n?void 0:n.value)||"";c.mutate({login:t,password:r})},children:[(0,b.jsx)(V,{label:"\u041b\u043e\u0433\u0438\u043d",children:(0,b.jsx)("input",{ref:s,type:"text",name:"login",required:!0})}),(0,b.jsx)(V,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",children:(0,b.jsx)("input",{ref:i,type:"password",name:"password",required:!0})}),(0,b.jsx)("button",{type:"submit",disabled:"loading"==c.status,children:"\u0412\u043e\u0439\u0442\u0438"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:"\u0414\u043b\u044f \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0438\u043b\u0435\u0442\u043e\u0432 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443 \u0443 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0435\u0433\u043e."}),(0,b.jsx)("div",{children:"\u0415\u0441\u043b\u0438 \u0432\u044b \u043f\u043e\u043f\u0430\u043b\u0438 \u0441\u044e\u0434\u0430, \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043f\u043e \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."})]})]})}function J(){var e=h();return(0,b.jsx)(R,{centered:!0,gap:"1em",children:x(e,"page_events")&&(0,b.jsx)(A.rU,{to:"/events",className:"button button_large",children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f"})})}var q={scanner:"styles_scanner__+xzXT",scannerRect:"styles_scannerRect__zwl3N",scannerVideo:"styles_scannerVideo__ZCceC",scanner_scanned:"styles_scanner_scanned__lX+Yf",scanned_anim:"styles_scanned_anim__UmXGC",scanResult:"styles_scanResult__35K03",big:"styles_big__bcOVH",success:"styles_success__dlqOt",result_desc:"styles_result_desc__oS+OA",error:"styles_error__0ctGO",alreadyScanned:"styles_alreadyScanned__OI-PM",alreadyScanned_visible:"styles_alreadyScanned_visible__keU3C"},W={root:"styles_root__QdJnV"},G=t(1096);function H(e){var n=e.active,t=void 0===n||n,r=e.className,s=e.onScan,i=e.onCameraError,a=(0,m.useState)(),c=(0,L.Z)(a,2),u=c[0],o=c[1],l=(0,m.useRef)(null);return(0,m.useEffect)((function(){if(l.current){var e=new G.Z(l.current,(function(e){return s(e.data)}),{highlightScanRegion:!0,maxScansPerSecond:10});return o((function(n){return null===n||void 0===n||n.stop(),null===n||void 0===n||n.destroy(),e})),e.start().catch((function(){return i()})),function(){e.stop(),e.destroy()}}}),[l,s]),(0,m.useEffect)((function(){u&&(t?u.start().catch((function(){return i()})):u.pause(!1))}),[t,u]),(0,b.jsx)("video",{className:k(W.root,r),ref:l})}function X(e,n){return"".concat(e).padStart(n,"0")}function $(e,n,t,r){var s="".concat(e);return"1"==s.at(-1)&&"1"!=s.at(-2)?n:["2","3","4"].includes(s.at(-1)||"")&&"1"!=s.at(-2)?t:r}function ee(e){return e?"".concat(X(e.getDate(),2),".").concat(X(e.getMonth()+1,2),".").concat(e.getFullYear()):""}function ne(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t="".concat(X(e.getHours(),2),":").concat(X(e.getMinutes(),2));return n?t+":".concat(X(e.getSeconds(),2)):t}function te(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"second",t=new Date,r=e.getTime()-t.getTime(),s=Math.floor(Math.abs(r)/1e3),i=Math.floor(s/31104e3);s-=60*i*60*24*30*12;var a=Math.floor(s/2592e3);s-=60*a*60*24*30;var c=Math.floor(s/86400);s-=60*c*60*24;var u=Math.floor(s/3600)%24;s-=60*u*60;var o=Math.floor(s/60)%60,l=(s-=60*o)%60;var d=function(){var e=function(e){return[e,["","",""]]};return 0!=i?[i,["\u0433\u043e\u0434","\u0433\u043e\u0434\u0430","\u043b\u0435\u0442"]]:0!=a?[a,["\u043c\u0435\u0441\u044f\u0446","\u043c\u0435\u0441\u044f\u0446\u0430","\u043c\u0435\u0441\u044f\u0446\u043e\u0432"]]:0!=c?[c,["\u0434\u0435\u043d\u044c","\u0434\u043d\u044f","\u0434\u043d\u0435\u0439"]]:"day"==n?e("\u0421\u0435\u0433\u043e\u0434\u043d\u044f"):0!=u?[u,["\u0447\u0430\u0441","\u0447\u0430\u0441\u0430","\u0447\u0430\u0441\u043e\u0432"]]:"hour"==n?e("\u0421\u0435\u0439\u0447\u0430\u0441"):0!=o?[o,["\u043c\u0438\u043d\u0443\u0442\u0430","\u043c\u0438\u043d\u0443\u0442\u044b","\u043c\u0438\u043d\u0443\u0442"]]:"minute"==n?e("\u0421\u0435\u0439\u0447\u0430\u0441"):0!=l?[l,["\u0441\u0435\u043a\u0443\u043d\u0434\u0430","\u0441\u0435\u043a\u0443\u043d\u0434\u044b","\u0441\u0435\u043a\u0443\u043d\u0434"]]:e("\u0422\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e")}(),h=(0,L.Z)(d,2),v=h[0],f=h[1];if("string"==typeof v)return v;var x="".concat($.apply(void 0,[v].concat((0,O.Z)(f))));return Math.abs(v)>1&&(x=Math.abs(v)+" "+x),r>0?x="\u0427\u0435\u0440\u0435\u0437 "+x:x+=" \u043d\u0430\u0437\u0430\u0434",x}var re={root:"styles_root__E-Z+Q",top:"styles_top__r6L7-",bottom:"styles_bottom__GMtUi"};function se(e){var n=e.event,t=e.onInputBtn;return(0,b.jsxs)("div",{className:re.root,children:[(0,b.jsx)("div",{className:re.top,children:(0,b.jsx)("button",{onClick:t,children:"\u0420\u0443\u0447\u043d\u043e\u0439 \u0432\u0432\u043e\u0434"})}),(0,b.jsxs)("div",{className:re.bottom,children:[(0,b.jsx)("span",{children:n.name}),(0,b.jsx)("span",{children:"|"}),(0,b.jsx)("span",{children:ee(n.date)})]})]})}function ie(){return ae.apply(this,arguments)}function ae(){return(ae=(0,i.Z)((0,s.Z)().mark((function e(){var n,t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/events");case 2:return n=e.sent,e.next=5,n.json();case 5:if(t=e.sent,n.ok){e.next=8;break}throw new d(t.msg);case 8:return r=t,e.abrupt("return",r.map(de));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e){return(0,a.useQuery)(["event","".concat(e)],(function(){return function(e){return ue.apply(this,arguments)}(e)}))}function ue(){return(ue=(0,i.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/events/"+n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new d(r.msg);case 8:return e.abrupt("return",de(r));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e){return(0,a.useQuery)(["event","".concat(e)],(function(){return function(e){return le.apply(this,arguments)}(e)}))}function le(){return(le=(0,i.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/scanner_event/"+n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}return e.abrupt("return",NaN);case 8:return e.abrupt("return",de(r));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){var n=e;return n.date=new Date(e.date),n}function he(e){return ve.apply(this,arguments)}function ve(){return(ve=(0,i.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/event",n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new d(r.msg);case 8:return e.abrupt("return",de(r));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fe={root:"styles_root__O0923",open:"styles_open__35Vcu",popup:"styles_popup__L-0H0",header:"styles_header__o87wG",close:"styles_close__w0Yhz",body:"styles_body__t75Nd"};function xe(e){var n=e.children,t=e.open,r=void 0!==t&&t,s=e.close,i=e.title,a=void 0===i?"":i;return(0,b.jsx)("div",{className:k(fe.root,r&&fe.open),children:(0,b.jsxs)("div",{className:fe.popup,children:[(a||s)&&(0,b.jsxs)("div",{className:fe.header,children:[(0,b.jsx)("h3",{children:a}),s&&(0,b.jsx)("button",{className:fe.close,onClick:s,children:"\u2716"})]}),(0,b.jsx)("div",{className:fe.body,children:n})]})})}function pe(e){return(0,a.useQuery)(["tickets",e],(function(){return function(e){return je.apply(this,arguments)}(e)}))}function je(){return(je=(0,i.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/tickets/"+n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new d(r.msg);case 8:return e.abrupt("return",r.map(me));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e){var n=e;return e.scannedDate&&(n.scannedDate=new Date(e.scannedDate)),e.createdDate&&(n.createdDate=new Date(e.createdDate)),n}function _e(e){return ye.apply(this,arguments)}function ye(){return(ye=(0,i.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/ticket",n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new d(r.msg);case 8:return e.abrupt("return",me(r));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return ge.apply(this,arguments)}function ge(){return(ge=(0,i.Z)((0,s.Z)().mark((function e(n){var t,r,i,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/check_ticket",n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new d(r.msg);case 8:return a=r,(i=r).ticket&&(a.ticket=me(i.ticket)),i.event&&(a.event=de(i.event)),e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){var n=(0,m.useState)((function(){var n=new Audio(e);return n.preload="auto",n})),t=(0,L.Z)(n,1)[0];return[function(){t.currentTime=0,t.play()}]}var Ae=t.p+"static/media/beep.38f199e084efe5461ffd.mp3",Ne=t.p+"static/media/beepError.7eccfa35a3dd6b6ea311.mp3";function Ze(e,n){return"".concat(X(e,3),"-").concat(n.getFullYear().toString().at(-1)).concat(X(n.getMonth()+1,2)).concat(X(n.getDate(),2),"-")}function we(){z("\u0421\u043a\u0430\u043d\u0435\u0440");var e,n=(0,r.UO)(),t=(0,m.useState)(null),s=(0,L.Z)(t,2),i=s[0],c=s[1],u=(0,m.useState)(null),o=(0,L.Z)(u,2),l=o[0],h=o[1],v=(0,m.useState)(null),f=(0,L.Z)(v,2),x=f[0],p=f[1],j=(0,m.useState)(null),_=(0,L.Z)(j,2),y=_[0],g=_[1],A=(0,m.useState)(!0),N=(0,L.Z)(A,2),Z=N[0],w=N[1],S=(0,m.useState)(!1),C=(0,L.Z)(S,2),I=C[0],D=C[1],E=(0,m.useState)(!1),F=(0,L.Z)(E,2),Q=F[0],T=F[1],U=(0,m.useState)(!1),P=(0,L.Z)(U,2),O=P[0],B=P[1],Y=(0,m.useRef)(null),V=oe(n.eventId),K=ke(Ae),J=(0,L.Z)(K,1)[0],W=ke(Ne),G=(0,L.Z)(W,1)[0],X=(0,m.useCallback)((function(e){return c(e)}),[]),$=(0,m.useCallback)((function(){D(!0),Y.current&&V.data&&"number"!=typeof V.data&&(Y.current.value=Ze(V.data.id,V.data.date))}),[Y,V.data]),re=(0,m.useCallback)((function(){return D(!1)}),[]),ie=function(e,n){var t=(0,a.useMutation)({mutationFn:be,onSuccess:function(n){null===e||void 0===e||e(n)},onError:function(e){null===n||void 0===n||n(e instanceof d?e.message:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"),t.reset()}});return t}((function(e){g(e),e.success||G()}),(function(e){g(null),p(e)}));return(0,m.useEffect)((function(){if(i&&V.data&&"idle"==ie.status&&"number"!=typeof V.data){if(J(),l==i)return c(null),void T(!0);T(!1),h(i),p(null),g(null),ie.mutate({code:i,eventId:V.data.id})}}),[i,V.data,ie.status]),(0,m.useEffect)((function(){if(ie.isSuccess){var e=setTimeout((function(){c(null),ie.reset()}),1e3);return function(){return clearTimeout(e)}}}),[ie.isSuccess]),(0,m.useEffect)((function(){if(Q){var e=setTimeout((function(){return T(!1)}),500);return function(){return clearTimeout(e)}}}),[Q]),(0,b.jsxs)(b.Fragment,{children:[V.isLoading&&(0,b.jsx)(M,{}),V.error&&(0,b.jsx)(R,{centered:!0,gap:"1em",header:null,children:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"}),"number"==typeof V.data&&(0,b.jsxs)(R,{centered:!0,centeredPage:!0,gap:"1em",header:null,children:[(0,b.jsx)("div",{children:"\u042d\u0442\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u0435 \u0435\u0449\u0451 \u043d\u0435 \u043d\u0430\u0447\u0430\u043b\u043e\u0441\u044c \u0438\u043b\u0438 \u0443\u0436\u0435 \u043a\u043e\u043d\u0447\u0438\u043b\u043e\u0441\u044c"}),(0,b.jsx)("div",{children:"\u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u043d\u0435 \u0442\u0430\u043a, \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0439 \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0440\u0438\u0451\u043c \u0431\u0438\u043b\u0435\u0442\u043e\u0432"})]}),"number"!=typeof V.data&&V.data&&(0,b.jsxs)(R,{height100:!0,header:(0,b.jsx)(se,{event:V.data,onInputBtn:$}),children:[(0,b.jsx)("div",{className:k(q.scanner,!ie.isIdle&&q.scanner_scanned),children:(0,b.jsx)("div",{className:q.scannerRect,children:(0,b.jsx)(H,{onScan:X,onCameraError:function(){return B(!0)},className:q.scannerVideo})})}),(0,b.jsxs)("div",{className:q.scanResult,children:[(0,b.jsx)("div",{className:k(q.alreadyScanned,Q&&q.alreadyScanned_visible),children:"\u0422\u043e\u0442 \u0436\u0435 \u0431\u0438\u043b\u0435\u0442"}),l&&(0,b.jsxs)("div",{children:["\u041a\u043e\u0434 \u0431\u0438\u043b\u0435\u0442\u0430: ",l]}),x&&(0,b.jsx)("div",{children:x}),(null===y||void 0===y?void 0:y.success)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:k(q.success,q.big),children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u0435\u043d"}),(0,b.jsxs)("div",{className:q.result_desc,children:[(0,b.jsxs)("div",{children:["\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c: ",y.ticket.personName]}),(0,b.jsxs)("div",{children:["\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430: ",y.ticket.type]}),(0,b.jsxs)("div",{children:["\u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434: ",y.ticket.promocode]})]})]}),"notExist"==(null===y||void 0===y?void 0:y.errorCode)&&(0,b.jsx)("div",{className:k(q.error,q.big),children:"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"}),"event"==(null===y||void 0===y?void 0:y.errorCode)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:k(q.error,q.big),children:"\u0414\u0440\u0443\u0433\u043e\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"}),(0,b.jsxs)("div",{className:q.result_desc,children:[(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:["\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435: ",y.event.name]}),(0,b.jsxs)("div",{children:["\u0415\u0433\u043e \u0434\u0430\u0442\u0430: ",ee(y.event.date)," (",te(y.event.date,"day"),")"]})]}),(0,b.jsxs)("div",{children:["\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c: ",y.ticket.personName]})]})]}),"scanned"==(null===y||void 0===y?void 0:y.errorCode)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:k(q.error,q.big),children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0439"}),(0,b.jsxs)("div",{className:q.result_desc,children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{children:"\u041a\u043e\u0433\u0434\u0430: "}),(0,b.jsxs)("span",{children:[ne(y.ticket.scannedDate,!0)," "]}),(0,b.jsxs)("span",{className:k((e=y.ticket.scannedDate,((new Date).getTime()-e.getTime())/1e3>30&&q.error)),children:["(",te(y.ticket.scannedDate),")"]})]}),(0,b.jsxs)("div",{style:{marginTop:"0.5rem"},children:["\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c: ",y.ticket.personName]}),(0,b.jsxs)("div",{children:["\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430: ",y.ticket.type]}),(0,b.jsxs)("div",{children:["\u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434: ",y.ticket.promocode]})]})]})]}),(0,b.jsxs)(xe,{title:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0431\u0438\u043b\u0435\u0442\u0430",open:I,close:re,children:[(0,b.jsx)("input",{type:"text",ref:Y}),(0,b.jsx)("button",{disabled:"idle"!=ie.status,onClick:function(){var e;Y.current&&c(null===(e=Y.current)||void 0===e?void 0:e.value),re()},children:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c"})]}),(0,b.jsxs)(xe,{open:O,children:[(0,b.jsx)("h1",{children:"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043a\u0430\u043c\u0435\u0440\u0435"}),(0,b.jsx)("p",{children:"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u043c\u0435\u0440\u044b \u044d\u0442\u043e\u043c\u0443 \u0441\u0430\u0439\u0442\u0443 \u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0443, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0442\u0435."}),(0,b.jsx)("p",{children:"\u041f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443."})]}),(0,b.jsxs)(xe,{title:"\u0421\u043a\u0430\u043d\u0435\u0440 \u0431\u0438\u043b\u0435\u0442\u043e\u0432",open:Z,close:function(){return w(!1)},children:[(0,b.jsx)("h2",{children:V.data.name}),(0,b.jsx)("p",{children:"\u0414\u043b\u044f \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0431\u0438\u043b\u0435\u0442\u0430 \u043d\u0430\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u0430\u043c\u0435\u0440\u0443 \u043d\u0430 QR \u043a\u043e\u0434 \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u043e\u043d \u043f\u043e\u043c\u0435\u0441\u0442\u0438\u043b\u0441\u044f \u0432 \u043c\u0438\u0433\u0430\u044e\u0449\u0443\u044e \u0440\u0430\u043c\u043a\u0443."}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0437\u0432\u0443\u043a"}),", \u0447\u0442\u043e\u0431\u044b \u0441\u043b\u044b\u0448\u0430\u0442\u044c \u0441\u0438\u0433\u043d\u0430\u043b \u043f\u0440\u0438 \u0441\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438."]})]})]})]})}var Se={space_between:"styles_space_between__AD+M6"};function Ce(e){var n=e.open,t=e.close,r=(0,m.useRef)(null),s=(0,m.useRef)(null),i=function(e){var n=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:he,onSuccess:function(t){var r;n.setQueryData(["event",t.id],(function(){return t})),"success"==(null===(r=n.getQueryState("events"))||void 0===r?void 0:r.status)&&n.setQueryData("events",(function(e){return e?[].concat((0,O.Z)(e),[t]):[t]})),null===e||void 0===e||e()}})}(t);return(0,b.jsxs)(xe,{open:n,close:t,title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u044f\u0442\u0438\u044f",children:[i.isError&&(0,b.jsx)("h3",{style:{color:"tomato",textAlign:"center"},children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),(0,b.jsxs)(Y,{onSubmit:function(){var e,n,t=null===(e=r.current)||void 0===e?void 0:e.value,a=null===(n=s.current)||void 0===n?void 0:n.value;t&&a&&i.mutate({date:a,name:t})},children:[(0,b.jsx)(V,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",children:(0,b.jsx)("input",{ref:r,type:"text",required:!0})}),(0,b.jsx)(V,{label:"\u0414\u0430\u0442\u0430",children:(0,b.jsx)("input",{ref:s,type:"datetime-local",required:!0})}),(0,b.jsx)("button",{type:"submit",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]}),i.isLoading&&(0,b.jsx)(M,{})]})}function Ie(){var e;z("\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f");var n=(0,m.useState)(!1),t=(0,L.Z)(n,2),r=t[0],s=t[1],i=function(){var e=(0,a.useQueryClient)();return(0,a.useQuery)("events",ie,{onSuccess:function(n){n.forEach((function(n){return e.setQueryData(["event","".concat(n.id)],n)}))}})}();return(0,b.jsxs)(R,{centeredPage:!0,gap:"1rem",children:[(0,b.jsx)("h1",{children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f"}),i.isLoading&&(0,b.jsx)(M,{}),i.isError&&(0,b.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),null===(e=i.data)||void 0===e?void 0:e.map((function(e){return(0,b.jsxs)(A.rU,{to:"/events/".concat(e.id),className:k("button button_large",Se.space_between),children:[(0,b.jsx)("span",{children:e.name}),(0,b.jsx)("span",{children:ee(e.date)})]},e.id)})),p("add_event")&&(0,b.jsxs)("div",{className:Se.space_between,children:[(0,b.jsx)("span",{}),(0,b.jsx)("button",{className:"button",onClick:function(){return s(!0)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]}),(0,b.jsx)(Ce,{open:r,close:function(){return s(!1)}})]})}function De(){return z("\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438"),(0,b.jsx)(R,{centered:!0,children:"\u0422\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u043e\u0432"})}var Ee={card:"styles_card__1zOYj",card__header:"styles_card__header__o4cfX",card__body:"styles_card__body__KU56x",gap:"styles_gap__Z5dnR",right:"styles_right__fxm89"};function Me(e){return(0,a.useQuery)(["ticket_types",e],(function(){return function(e){return Fe.apply(this,arguments)}(e)}))}function Fe(){return(Fe=(0,i.Z)((0,s.Z)().mark((function e(n){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/ticket_types/"+n);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,t.ok){e.next=8;break}throw new d(r.msg);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(e,n){var t=(0,a.useQueryClient)(),r=(0,a.useMutation)({mutationFn:function(n){return function(e,n){return Re.apply(this,arguments)}(e,n)},onSuccess:function(r){t.setQueryData(["ticket_types","".concat(e)],(function(){return r})),null===n||void 0===n||n(r)}});return r}function Re(){return(Re=(0,i.Z)((0,s.Z)().mark((function e(n,t){var r,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/api/ticket_types/"+n,t);case 2:return r=e.sent,e.next=5,r.json();case 5:if(i=e.sent,r.ok){e.next=8;break}throw new d(i.msg);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e){var n,t,r,s=e.open,i=e.eventId,c=e.close,u=e.setTicet,o=(0,m.useRef)(null),l=(0,m.useRef)(null),d=(0,m.useRef)(null),h=(0,m.useRef)(null),v=(0,m.useRef)(null),f=function(e){var n=(0,a.useQueryClient)();return(0,a.useMutation)({mutationFn:_e,onSuccess:function(t){var r;"success"==(null===(r=n.getQueryState(["tickets","".concat(t.eventId)]))||void 0===r?void 0:r.status)&&n.setQueryData(["tickets","".concat(t.eventId)],(function(e){return e?[].concat((0,O.Z)(e),[t]):[t]})),null===e||void 0===e||e(t)}})}((function(e){u(e),null===c||void 0===c||c()})),x=Me(i);return(0,b.jsxs)(xe,{open:s,close:c,title:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u0438\u043b\u0435\u0442\u0430",children:[f.isError&&(0,b.jsx)("h3",{style:{color:"tomato",textAlign:"center"},children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),x.isLoading&&(0,b.jsx)(M,{}),(0,b.jsxs)(Y,{onSubmit:function(){var e,n,t,r,s,a=null===(e=o.current)||void 0===e?void 0:e.value,c=null===(n=l.current)||void 0===n?void 0:n.value,u=(null===(t=d.current)||void 0===t?void 0:t.value)||"",x=(null===(r=h.current)||void 0===r?void 0:r.value)||"",p=(null===(s=v.current)||void 0===s?void 0:s.value)||"";a&&c&&f.mutate({eventId:parseInt("".concat(i),10),typeId:parseInt(a,10),personName:c,personLink:u,promocode:x,code:p})},children:[(0,b.jsxs)(V,{label:"\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430",children:[(0,b.jsx)("select",{ref:o,disabled:0==(null===(n=x.data)||void 0===n?void 0:n.length),required:!0,children:null===(t=x.data)||void 0===t?void 0:t.map((function(e){return(0,b.jsx)("option",{value:e.id,children:e.name},e.id)}))}),0==(null===(r=x.data)||void 0===r?void 0:r.length)&&(0,b.jsx)("h4",{children:"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u0438\u043f\u044b \u0431\u0438\u043b\u0435\u0442\u043e\u0432"})]}),(0,b.jsx)(V,{label:"\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c",children:(0,b.jsx)("input",{ref:l,type:"text",required:!0})}),(0,b.jsx)(V,{label:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044f",children:(0,b.jsx)("input",{ref:d,type:"text"})}),(0,b.jsx)(V,{label:"\u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434",children:(0,b.jsx)("input",{ref:h,type:"text"})}),(0,b.jsx)("button",{type:"submit",disabled:!x.data||0==x.data.length,children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]}),f.isLoading&&(0,b.jsx)(M,{})]})}var Ue={root:"styles_root__Lo44K",visible:"styles_visible__icoL+",center:"styles_center__w1Z-q"},Le=t(741),Pe=t(5498),Oe=t.n(Pe);function ze(e){var n=e.event,t=e.ticket,r=e.setTicket,s=(0,m.useState)(null),i=(0,L.Z)(s,2),a=i[0],c=i[1],u=(0,m.useState)(""),o=(0,L.Z)(u,2),l=o[0],d=o[1],h=(0,m.useRef)(null);return(0,m.useEffect)((function(){t&&(c(null),d(""),Le.toDataURL(t.code,{errorCorrectionLevel:"H",scale:8},(function(e,n){return d(n)})))}),[t]),(0,m.useEffect)((function(){if(l&&h.current){var e=setTimeout((function(){l&&h.current&&Oe()(h.current).then((function(e){return c(e)}))}),10);return function(){return clearTimeout(e)}}}),[l,h]),(0,b.jsxs)(xe,{open:!!t,close:function(){return r(null)},title:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0431\u0438\u043b\u0435\u0442\u0430",children:[(0,b.jsxs)("div",{ref:h,className:k(Ue.root,!a&&Ue.visible),children:[(0,b.jsx)("h1",{children:"\u0411\u0438\u043b\u0435\u0442"}),(0,b.jsx)("div",{className:Ue.center,style:{marginTop:"1rem"},children:(0,b.jsx)("img",{src:l,alt:null===t||void 0===t?void 0:t.code})}),(0,b.jsx)("div",{className:Ue.center,style:{marginBottom:"1rem"},children:null===t||void 0===t?void 0:t.code}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{children:["\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435: ",null===n||void 0===n?void 0:n.name]}),(0,b.jsxs)("div",{children:["\u0414\u0430\u0442\u0430: ",ee(null===n||void 0===n?void 0:n.date)]}),(0,b.jsxs)("div",{children:["\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430: ",null===t||void 0===t?void 0:t.type]}),(0,b.jsxs)("div",{children:["\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c: ",null===t||void 0===t?void 0:t.personName]})]})]}),a&&(0,b.jsx)("div",{ref:function(e){e&&(e.innerHTML="",e.appendChild(a))}}),a&&(0,b.jsx)("div",{className:Ue.center,children:"\u042d\u0442\u043e \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430, \u043c\u043e\u0436\u043d\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})}function Be(e){var n,t,r=e.eventId,s=e.open,i=e.close,a=(0,m.useState)(0),c=(0,L.Z)(a,2),u=(c[0],c[1]),o=(0,m.useState)(new Map),l=(0,L.Z)(o,2),d=l[0],h=(l[1],(0,m.useState)([])),v=(0,L.Z)(h,2),f=v[0],x=(v[1],Me(r)),p=Qe(r,i);return(0,b.jsxs)(xe,{open:s,close:i,title:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0432\u0438\u0434\u043e\u0432 \u0431\u0438\u043b\u0435\u0442\u043e\u0432",children:[p.isError&&(0,b.jsx)("h3",{style:{color:"tomato",textAlign:"center"},children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),x.isLoading&&(0,b.jsx)(M,{}),p.isLoading&&(0,b.jsx)(M,{}),(0,b.jsxs)(Y,{onSubmit:function(){d.size>0&&p.mutate([].concat((0,O.Z)(f.filter((function(e){return"add"==e.action}))),(0,O.Z)(Array.from(d.values()))))},children:[null===(n=x.data)||void 0===n||null===(t=n.filter((function(e){var n;return"delete"!=(null===(n=d.get(e.id))||void 0===n?void 0:n.action)})))||void 0===t?void 0:t.map((function(e){var n;return(0,b.jsxs)(V,{children:[(0,b.jsx)("input",{type:"text",required:!0,value:(null===(n=d.get(e.id))||void 0===n?void 0:n.name)||e.name,onChange:function(n){d.set(e.id,{id:e.id,name:n.target.value,action:"update"}),u((function(e){return e+1}))}}),(0,b.jsx)("button",{type:"button",onClick:function(){d.set(e.id,{id:e.id,name:"",action:"delete"}),u((function(e){return e+1}))},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]},e.id)})),f.filter((function(e){return"add"==e.action})).map((function(e,n){return(0,b.jsxs)(V,{children:[(0,b.jsx)("input",{type:"text",required:!0,onChange:function(e){f[n].name=e.target.value,u((function(e){return e+1}))}}),(0,b.jsx)("button",{type:"button",onClick:function(){f[n].action="delete",u((function(e){return e+1}))},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]},"new"+n)})),(0,b.jsx)("button",{onClick:function(){f.push({name:"",action:"add"}),u((function(e){return e+1}))},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),(0,b.jsx)("button",{type:"submit",children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c"})]})]})}function Ye(){var e,n,t=(0,m.useState)(!1),s=(0,L.Z)(t,2),i=s[0],a=s[1],c=(0,m.useState)(!1),u=(0,L.Z)(c,2),o=u[0],l=u[1],d=(0,m.useState)(null),h=(0,L.Z)(d,2),v=h[0],f=h[1],x=(0,r.UO)().eventId,j=ce(x),_=Me(x),y=p("add_ticket");return z((null===(e=j.data)||void 0===e?void 0:e.name)||"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"),(0,b.jsxs)(b.Fragment,{children:[j.isLoading&&(0,b.jsx)(R,{children:(0,b.jsx)(M,{})}),j.isError&&(0,b.jsx)(R,{centered:!0,children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),j.data&&(0,b.jsxs)(R,{centeredPage:!0,gap:"1rem",children:[(0,b.jsxs)("h1",{children:["\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435: ",j.data.name]}),(0,b.jsxs)("div",{className:Ee.card,children:[(0,b.jsxs)("div",{className:Ee.card__header,children:[(0,b.jsx)("h2",{children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"}),(0,b.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]}),(0,b.jsxs)("div",{className:Ee.card__body,children:[(0,b.jsxs)("div",{children:["\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435: ",j.data.name]}),(0,b.jsxs)("div",{children:["\u0414\u0430\u0442\u0430 \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f: ",ee(j.data.date)]})]})]}),(0,b.jsxs)("div",{className:Ee.card,children:[(0,b.jsxs)("div",{className:Ee.card__header,children:[(0,b.jsx)("h2",{children:"\u0412\u0438\u0434\u044b \u0431\u0438\u043b\u0435\u0442\u043e\u0432"}),(0,b.jsx)("button",{className:"button",onClick:function(){return l(!0)},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,b.jsx)(Be,{eventId:x,open:o,close:function(){return l(!1)}})]}),(0,b.jsxs)("div",{className:Ee.card__body,children:[_.isLoading&&(0,b.jsx)("div",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),_.isError&&(0,b.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),null===(n=_.data)||void 0===n?void 0:n.map((function(e){return(0,b.jsx)("div",{children:e.name},e.id)}))]})]}),(0,b.jsx)(A.rU,{to:"/scanner/".concat(x),className:"button",children:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0441\u043a\u0430\u043d\u0435\u0440"}),y&&(0,b.jsx)("button",{className:"button",onClick:function(){return a(!0)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0431\u0438\u043b\u0435\u0442"}),(0,b.jsx)(Te,{eventId:x,open:i,close:function(){return a(!1)},setTicet:f}),(0,b.jsx)(ze,{ticket:v,event:j.data,setTicket:f}),(0,b.jsx)(A.rU,{to:"/events/".concat(x,"/tickets"),className:"button",children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0431\u0438\u043b\u0435\u0442\u043e\u0432"}),(0,b.jsx)("div",{className:Ee.gap}),(0,b.jsx)("div",{className:Ee.right,children:(0,b.jsx)("button",{className:"button",onClick:function(){return alert("\u041f\u043e\u043a\u0430 \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442")},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})})]})]})}var Ve={center:"styles_center__9dZ9p",right:"styles_right__Zz+YX"};function Ke(){var e,n,t=(0,m.useState)(!1),s=(0,L.Z)(t,2),i=s[0],a=s[1],c=(0,m.useState)(null),u=(0,L.Z)(c,2),o=u[0],l=u[1],d=(0,r.UO)().eventId,h=ce(d),v=pe(d),f=p("add_ticket");return z([null===(e=h.data)||void 0===e?void 0:e.name,"\u0411\u0438\u043b\u0435\u0442\u044b"]),(0,b.jsxs)(b.Fragment,{children:[(h.isLoading||v.isLoading)&&(0,b.jsx)(R,{children:(0,b.jsx)(M,{})}),(h.isError||v.isError)&&(0,b.jsx)(R,{centered:!0,children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),h.data&&v.isSuccess&&(0,b.jsxs)(R,{centeredPage:!0,gap:"1rem",children:[(0,b.jsxs)("h1",{children:["\u0411\u0438\u043b\u0435\u0442\u044b: ",h.data.name]}),(0,b.jsxs)("div",{className:Ve.right,children:[(0,b.jsx)(A.rU,{target:"_blank",to:"/events/".concat(d,"/print_tickets"),className:"button",children:"\u0420\u0430\u0441\u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c"}),f&&(0,b.jsx)("button",{className:"button",onClick:function(){return a(!0)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),(0,b.jsx)(Te,{eventId:d,open:i,close:function(){return a(!1)},setTicet:l})]}),(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{style:{width:"11em"},children:"\u041a\u043e\u0434"}),(0,b.jsx)("th",{children:"\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c"}),(0,b.jsx)("th",{children:"\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430"}),(0,b.jsx)("th",{children:"\u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434"}),(0,b.jsxs)("th",{children:[(0,b.jsx)("div",{children:"\u0418\u0441\u043f\u043e\u043b\u044c"}),(0,b.jsx)("div",{children:"\u0437\u043e\u0432\u0430\u043d"})]}),(0,b.jsx)("th",{children:"\u0411\u0438\u043b\u0435\u0442"})]})}),(0,b.jsx)("tbody",{children:null===(n=v.data)||void 0===n?void 0:n.map((function(e){return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:e.code}),(0,b.jsx)("td",{children:e.personName}),(0,b.jsx)("td",{children:e.type}),(0,b.jsx)("td",{children:e.promocode}),(0,b.jsx)("td",{className:Ve.center,children:e.scanned?"\u2713":"\u2716"}),(0,b.jsx)("td",{className:Ve.center,children:(0,b.jsx)("button",{onClick:function(){return l(e)},children:"\u0411\u0438\u043b\u0435\u0442"})})]},e.id)}))})]}),(0,b.jsx)(ze,{ticket:o,event:h.data,setTicket:l})]})]})}var Je=t(1413),qe={root:"styles_root__QCWgG",table:"styles_table__Klrj7",center:"styles_center__pcMYz",mark:"styles_mark__4aU1o"};function We(){var e,n=(0,r.UO)().eventId,t=ce(n),s=pe(n);z([null===(e=t.data)||void 0===e?void 0:e.name,"\u0411\u0438\u043b\u0435\u0442\u044b"]);var i=(0,m.useMemo)((function(){if(!s.data||!t.data)return[!1,""];var e=Ze(t.data.id,t.data.date);return[s.data.every((function(n){return n.code.startsWith(e)})),e]}),[s.data,t.data]),a=(0,L.Z)(i,2),c=a[0],u=a[1];return(0,m.useEffect)((function(){if(t.isSuccess&&s.isSuccess){var e=setTimeout((function(){return window.print()}),1e3);return function(){return clearTimeout(e)}}}),[t.isSuccess,s.isSuccess]),(0,b.jsxs)(b.Fragment,{children:[(t.isLoading||s.isLoading)&&(0,b.jsx)(M,{}),(t.isError||s.isError)&&(0,b.jsx)("h1",{children:"\u041e\u0448\u0438\u0431\u043a\u0430"}),t.isSuccess&&s.isSuccess&&(0,b.jsx)("div",{className:qe.root,children:(0,b.jsxs)("table",{className:qe.table,children:[(0,b.jsxs)("thead",{children:[(0,b.jsx)("tr",{children:(0,b.jsxs)("th",{colSpan:5,children:[(0,b.jsx)("span",{children:t.data.name}),c&&(0,b.jsx)("span",{style:{marginLeft:"1rem"},children:"|"}),c&&(0,b.jsxs)("span",{style:{marginLeft:"1rem"},children:["\u0412\u0441\u0435 \u043a\u043e\u0434\u044b \u0434\u043e\u0436\u043d\u044b \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0441 ",u]})]})}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"\u041a\u043e\u0434"}),(0,b.jsx)("th",{children:"\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u0435\u043b\u044c"}),(0,b.jsx)("th",{children:"\u0422\u0438\u043f \u0431\u0438\u043b\u0435\u0442\u0430"}),(0,b.jsx)("th",{children:"\u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434"}),(0,b.jsxs)("th",{children:[(0,b.jsx)("div",{children:"\u0418\u0441\u043f\u043e\u043b\u044c"}),(0,b.jsx)("div",{children:"\u0437\u043e\u0432\u0430\u043d"})]})]})]}),(0,b.jsx)("tbody",{children:s.data.map((function(e){return c?(0,Je.Z)((0,Je.Z)({},e),{},{code:e.code.slice(u.length),sortV:e.code.slice(e.code.lastIndexOf("-"))}):(0,Je.Z)((0,Je.Z)({},e),{},{sortV:e.code})})).sort((function(e,n){return e.sortV>n.sortV?1:-1})).map((function(e){return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:e.code}),(0,b.jsx)("td",{children:e.personName}),(0,b.jsx)("td",{children:e.type}),(0,b.jsx)("td",{children:e.promocode}),(0,b.jsx)("td",{className:qe.center,children:(0,b.jsx)("span",{className:qe.mark,children:e.scanned&&"\u2713"})})]},e.id)}))})]})})]})}function Ge(){var e,n=h();function t(e,t,s){var i;return(0,b.jsx)(r.AW,{path:t,element:null!==(i=n.data)&&void 0!==i&&i.auth?null==e||x(n,e)?s:(0,b.jsx)(U,{}):(0,b.jsx)(r.Fg,{to:"/auth"})})}return(0,b.jsxs)("div",{className:"root",children:[(0,b.jsx)(_,{}),n.isLoading&&(0,b.jsx)(j.Z,{}),n.isError&&"\u041e\u0448\u0438\u0431\u043a\u0430",n.isSuccess&&(0,b.jsxs)(r.Z5,{children:[(0,b.jsx)(r.AW,{path:"/auth",element:null!==(e=n.data)&&void 0!==e&&e.auth?(0,b.jsx)(r.Fg,{to:"/"}):(0,b.jsx)(K,{})}),(0,b.jsx)(r.AW,{path:"/scanner/:eventId",element:(0,b.jsx)(we,{})}),t(null,"/",(0,b.jsx)(J,{})),t("page_events","/events",(0,b.jsx)(Ie,{})),t("page_events","/events/:eventId",(0,b.jsx)(Ye,{})),t("page_events","/events/:eventId/tickets",(0,b.jsx)(Ke,{})),t("page_events","/events/:eventId/print_tickets",(0,b.jsx)(We,{})),t("page_staff","/staff",(0,b.jsx)(De,{})),t(null,"*",(0,b.jsx)(T,{}))]})]})}}}]);
//# sourceMappingURL=424.77b66e4c.chunk.js.map